---
layout: post
title: "vue framework note2"
date: 2020-08-01
category: Frontend
author: zhengjunan
published: true
photoswipe: true
syntaxhighlight: true
---

# 组件

vue 组件 = vue 实例 = new Vue(options)

# 属性

1. 自定义属性`props`: 组件 props 中声明的属性
2. 原生属性`attrs`: 没有声明的属性，默认自动挂载到组件的根元素上，设置 inheritAttrs 为 false 可以关闭自动挂载
3. 特殊属性`class style`: 挂载到组件根元素上，支持字符串，对象，数组

# 事件

1. 普通事件： `@click, @input, @change, @xxx`等事件，通过`this.$emit('xxx', ....)`触发
2. 修饰符事件: `@input.trim, @click.stop, @submit.prevent`

# 插槽

1. 普通插槽：
   `<template slot="xxx">...</template>`
   `<template v-slot:xxx>...</template>`
2. 作用域插槽：
   `<template slot="xxx" slot-scope="props">...</template>`
   `<template v-slot:xxx="props">...</template>`

# 双向绑定和单向数据流

数据来源（单向）:

1. 来自父元素属性
2. 来自组件自身状态 data
3. 来自状态管理器, vuex, Vue.observable

# 虚拟 DOM 和 key

# 组件触发更新

状态 data 和属性 props:

1. 状态是组件自身的数据
2. 属性是来自父组件的数据
3. 状态的改变未必会触发更新
4. 属性的改变未必会触发更新

# 计算属性和监听器

计算属性 computed

1. 减少模版中计算逻辑
2. 数据缓存
3. 依赖固定的数据结构（响应式数据）

监听器 watch

1. 更加灵活、通用
2. watch 中可以执行任何逻辑，如函数节流，Ajax 异步获取数据，操作 DOM

# 生命周期的应用场景和函数式组件

![截屏2021-05-13 17.08.23](https://i.imgur.com/0JWbyY1.png)

![截屏2021-05-13 17.13.21](https://i.imgur.com/zm3gdwE.png)

![截屏2021-05-13 17.15.52](https://i.imgur.com/n5hmOdb.png)

# 函数式组件

1. `functional: true`
2. 无状态、无实例、没有 this 上下文、无生命周期
3. 避免重复计算，使用临时变量

# 内置指令

- `v-text`
- `v-html`
- `v-show`
- `v-if`
- `v-else`
- `v-else-if`
- `v-for`
- `v-on`
- `v-bind`
- `v-model`
- `v-slot`
- `v-pre`
- `v-cloak`
- `v-once`

生命周期钩子
自定义指令：
`bind`
`inserted`
`update`
`componentUpdated`
`unbind`

# 常用高级特性 `provide/inject`

组件通信，不同层级组件属性传递，层层冒泡的方式取数据。
同级组件之间的通信
上层组件使用 provide, 下层组件使用 inject
可使用 Vue.observable 优化响应式 provide

# 跨层级获取组件实例

ref 引用消息
callback ref:

- 主动通知(setXxxRef)
- 主动获取(getXxxRef)

# template 和 jsx

template:

- 模版语法（HTML 拓展）
- 数据绑定使用 Mustache 语法（双大括号）

JSX:

- JavaScript 的语法拓展
- 数据绑定使用单引号

# VueX

![截屏2021-05-15 00.59.03](https://i.imgur.com/RdgYjSF.png)

- State -- `this.$store.state.xxx`

- Getter -- `this.$store.getters.xxx`

- Mutation -- `this.$store.commit("xxx")`

- Action -- `this.$store.dispatch("xxx")`

- Module

底层原理：

- State: 提供响应式数据
- Getter: 借助 Vue 的计算属性 computed 来实现缓存
- Mutation: 更改 state 方法
- Action: 触发 mutation 方法
- Moduel: Vue.set 动态添加 state 到响应式数据中

# Vuex 的最佳实践

- State -- `this.$store.state.xxx` -- `mapState` 取值

- Getter -- `this.$store.getters.xxx` -- `mapGetters` 取值

- Mutation -- `this.$store.commit("xxx")` -- `mapMutations` 赋值

- Action -- `this.$store.dispatch("xxx")` -- `mapActions` 赋值

- Module

使用常量代替 Mutation 事件类型

```javascript
export const SOME_MUTATION = "SOME_MUTATION";
```

Moduel

- 开启命名空间`namespaced: true`
- 嵌套模块不要太深，尽量扁平化
- 灵活应用`createNamespacedHelpers`

# Vue Router

- 监听 URL 的变化，并在变化前后执行对应的逻辑
- 不同的 URL 对应不同的组件
- 提供多种方式改变 URL 的 API（URL 的改变不能导致浏览器刷新）

使用方式：

1. 提供一个路由配置表，不同的 URL 对应不同组件的配置
2. 初始化路由实例 new VueRouter()
3. 挂载到 Vue 实例上
4. 提供一个路由占位，用来挂载 URL 匹配到的组件

路由类型：

- Hash 模式：丑，无法使用锚点定位
- History 模式：需要后端配合，IE9 不兼容（可使用强制刷新处理）

![截屏2021-05-15 17.21.08](https://i.imgur.com/xZ2eFbx.png)

# Nuxt

- 静态站点
- 动态渲染
- 简化配置

ssr

![截屏2021-05-15 17.29.13](https://i.imgur.com/Lx2sWV7.png)

# UI 组件库

- Element UI 饿了么
- Ant Design Vue 蚂蚁金服
- iView

# 常用开发工具

- Vetur: 语法高亮、标签补全、模版生成、Lint 检查、格式化
- ESLint: 代码规范、错误检查
- Prettier: 代码格式化
- Vue DevTools: 集成 Vuex、可远程调试、性能分析

# 单元测试

使用方式：

- jest 或 mocha
- @vue/test-utils
- sinon
